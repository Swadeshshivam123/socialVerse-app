
<!-- Home page title -->
<h1><%= title %></h1>

<!-- Section for 'post-feeds' on home page -->
<section id="feed-posts">
  <h4>Posts</h4>

  <!-- Showing 'new-post-form' only when the user is signed in(successfully authenticated) -->
  <% if(locals.user){ %>
  <form action="/posts/create" id="new-post-form" method="POST">
    <textarea
      name="content"
      cols="30"
      rows="10"
      placeholder="Type here..."
    ></textarea>
    <br />
    <input type="submit" value="Post" />
  </form>
  <% } %>

  <!-- Displaying all the posts with their content and user's name -->
  <div id="posts-list-container">
    <ul>
        <% for(post of posts){ %>
            
        <li>
            <p>
              <% if(locals.user && locals.user.id==post.user.id) { %>
                <small>
                  <a href="/posts/destroy/<%= post.id %>"><button>Delete Post</button></a>
                </small> 
                <% } %> 
              <%= post.content %>
                <br>
                <small>
                    <%= post.user.name %>
                </small>
            </p>
            <!-- Form for posting comments on a post -->
            <div class="post-comments">
                <% if (locals.user){ %>
                    <form action="/comments/create" method="POST">
                        <input type="text" name="content" placeholder="Type Here to add comment..." required>
                        <input type="hidden" name="post" value="<%= post._id %>" >
                        <input type="submit" value="Add Comment">
                    </form>

                <% } %>

                <!-- Displaying all the comments on the post along with ther user's names who posted those comments -->
                <!-- User need not be logged in to watch the comments -->
                <div class="post-comments-list">
                    <ul id="post-comments-<%= post._id %>">
                        <% for (comment of post.comments){%>
                            
                        <p>

                          <% if(locals.user && (locals.user.id==comment.user.id || locals.user.id==post.user.id)) { %>
                            <small>
                              <a href="/comments/destroy/<%= comment.id %>"><button>Delete Comment</button></a>
                            </small> 
                            <% } %> 

                            <%= comment.content %>
                            <br>
                            <small>
                                <%= comment.user.name %>
                            </small>
                        </p>    
                        <%} %>
                    </ul>
                </div>
            </div>
            
        </li>
            
        <%} %>
    </ul>
</div>

</section>
